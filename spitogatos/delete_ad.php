<?php
session_start();

// Έλεγχος αυθεντικοποίησης χρήστη
if (!isset($_SESSION['username'])) {
    header("Location: login.php");
    exit;
}

// Υποθέτουμε ότι έχουμε σύνδεση στη βάση δεδομένων
// Κάντε τις απαραίτητες αλλαγές εδώ για να συμβαδίζει με την πραγματική σύνδεση σας.

if ($_SERVER["REQUEST_METHOD"] == "POST" && isset($_POST['ad_id'])) {
    // Λάβετε το αναγνωριστικό της αγγελίας προς διαγραφή
    $ad_id = $_POST['ad_id'];

    // Μετά τη διαγραφή, εμφανίζουμε ένα μήνυμα επιβεβαίωσης
    echo "Η αγγελία με αναγνωριστικό $ad_id διαγράφηκε επιτυχώς.";

    // Υλοποιήστε τον κώδικα για διαγραφή της αγγελίας από τη βάση δεδομένων
    $sql = "DELETE FROM ads WHERE ad_id='$ad_id' AND username='{$_SESSION['username']}'";

    if ($mysqli->query($sql) === TRUE) {
        echo "Η αγγελία διαγράφηκε με επιτυχία.";
    } else {
        echo "Σφάλμα κατά τη διαγραφή της αγγελίας: " . $mysqli->error;
    }
}
else {
    // Εάν δεν υπάρχει αίτημα POST ή δεν έχει δοθεί αναγνωριστικό αγγελίας, επιστρέφουμε στην αρχική σελίδα
    header("Location: index.php");
    exit;
}

// Κλείσιμο της σύνδεσης με τη βάση δεδομένων
$mysqli->close();
